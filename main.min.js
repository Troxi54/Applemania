!function(){"use strict";let e=e=>new Decimal(e);function t(e){return document.querySelector(e)}function a(t,l=2){if(!t&&0!==t)return;if(t instanceof Decimal&&!t.toNumber()&&0!==t.toNumber())return;t instanceof Decimal==!1&&(t=e(t));const p=["","k","M","B","T","Qd","Qn","Sx","Sp","Oc","No","Dc","Ud","Dd","Td","Qad","Qid","Sxd","Spd","Ocd","Nd","Vg","Uvg","Dvg","Tvg","Qavg","Qivg","Sxvg","Spvg","Ocvg","Nvg","Tg"];if(t.eq("0"))return"0";if(t.lt("1e3"))return t.toNumber().toFixed(l);if(t.lt("1e6"))return t.toNumber().toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,",");if(t.lt(e(1e3).pow(p.length))){const e=t.log(1e3).abs().floor(),a=t.div(Decimal.pow(1e3,e));return a.toFixed(3-+a.log(10).floor())+p[e.toNumber()]}if(t.lt("ee6")){let l=t.log10();return l=l.plus(l.div(1e9)).floor(),t.div(e(10).pow(l)).toNumber().toFixed(2)+"e"+a(l,0)}return"e"+a(t.log10(),l)}Element.prototype.hide=function(){this.style.display="none"},Element.prototype.show=function(){this.style.display=""};const l=60;let p={apples:e(0),appleGain:e(1),speed:4,size:1,appleArray:[],applesOnField:0,appleSpawningRate:.5,applesMax:4e3,level:e(0),levelRequirement:e(25),tier:e(0),upgrades:{au1:{cost:(t=p.upgrades.au1.lvl)=>e(10).times(e(5).pow(t)),bulk:()=>p.apples.div(10).log(5).minus(p.upgrades.au1.lvl).max(0).plus(1).floor(),condition:()=>p.apples.gte(p.upgrades.au1.cost()),effect:(t=p.upgrades.au1.lvl)=>e(1.225).pow(t),lvl:e(0)},au2:{cost:(t=p.upgrades.au2.lvl)=>e(20).times(e(5).pow(t)),bulk:()=>p.apples.div(20).log(5).minus(p.upgrades.au2.lvl).max(0).plus(1).floor(),condition:()=>p.apples.gte(p.upgrades.au2.cost()),effect:(t=p.upgrades.au2.lvl)=>e(1.2).pow(t),lvl:e(0)},au3:{cost:(t=p.upgrades.au3.lvl)=>e(30).times(e(2).pow(t)),bulk:()=>p.apples.div(30).log(2).minus(p.upgrades.au3.lvl).max(0).plus(1).floor(),condition:()=>p.apples.gte(p.upgrades.au3.cost()),effect:(t=p.upgrades.au3.lvl)=>e(1.25).pow(t),lvl:e(0)},au4:{cost:(t=p.upgrades.au4.lvl)=>e(40).times(e(1.275).pow(t)),bulk:()=>p.apples.div(40).log(1.275).minus(p.upgrades.au4.lvl).max(0).plus(1).floor(),condition:()=>p.apples.gte(p.upgrades.au4.cost()),effect:(t=p.upgrades.au4.lvl)=>e(1.1).pow(t),lvl:e(0)}},firstVisit:Date.now(),keyPressed:{}},s={update(e,t){e.innerHTML!==t&&(e.innerHTML=t)},at(){this.update(t("#at"),`You have <span class="apple">${a(p.apples,0)}</span> apples`)},ait(){this.update(t("#ait"),`${a(p.appleArray.length,0)}/${a(p.applesRealMax,0)} (+${a(p.appleSpawningRate,2)}/sec)`)},lp(){this.update(t("#lp"),`Level: <span class="level">${a(p.level,0)}</span> (<span class="apple">${a(p.apples,0)}</span>/<span class="apple">${a(p.levelRequirement,0)}</span> apples)`+(p.level.gte(1)?`<br><span class="italic"><span class="apple">${a(p.levelEffect)}x</span> apples</span>`:""))},au1(){this.update(t("#au1i"),`<h3>Level ${a(p.upgrades.au1.lvl,0)}</h3>Increase player size by <h3>x${a(p.upgrades.au1.effect(1))}</h3><br>${a(p.upgrades.au1.cost(),0)} apples`)},au2(){this.update(t("#au2i"),`<h3>Level ${a(p.upgrades.au2.lvl,0)}</h3>Increase player speed by <h3>x${a(p.upgrades.au2.effect(1))}</h3><br>${a(p.upgrades.au2.cost(),0)} apples`)},au3(){this.update(t("#au3i"),`<h3>Level ${a(p.upgrades.au3.lvl,0)}</h3>Increase apple cap by <h3>x${a(p.upgrades.au3.effect(1))}</h3><br> ${a(p.upgrades.au3.cost(),0)} apples`)},au4(){this.update(t("#au4i"),`<h3>Level ${a(p.upgrades.au4.lvl,0)}</h3>Increase apple grow speed by <h3>x${a(p.upgrades.au4.effect(1))}</h3><br>${a(p.upgrades.au4.cost(),0)} apples`)},tp(){this.update(t("#tp"),p.tier.gt(0)?`<span class="tp">Tier: <span class="tier">${a(p.tier,0)}</span></span> (<span class="size">${a(p.size,0)}</span>/<span class="size">${a(p.tierRequirement,0)}</span> size)<br><span class="italic"><span class="apple">${a(p.tierEffect)}x</span> apples</span>`:"")},updateAll(){for(let e in this)["updateAll","update"].includes(e)||this[e]()}},i={drawApples(){const e=t("#aac"),a=p.appleArray;e.width=e.getBoundingClientRect().width,e.height=e.getBoundingClientRect().height;const l=e.getContext("2d"),s=e.getBoundingClientRect().width;for(let i=0;i<p.appleArray.length;i++){const n=a[i].size;l.fillStyle=a[i].color;let[r,u]=[a[i].x*(s-n),a[i].y*(s-n)];const d=t("#p").getBoundingClientRect(),o=e.getBoundingClientRect().x+r,c=e.getBoundingClientRect().y+u;d.x+d.width>o&&d.x<o+a[i].size&&d.y+d.height>c&&d.y<c+a[i].size?(this.getApple(i),p.appleArray.splice(i,1),p.applesOnField--,i--):l.fillRect(r,u,n,n)}},spawnApple(){p.appleArray.length<p.applesRealMax&&p.appleArray.push({x:Math.random(),y:Math.random(),color:"#ff0000",size:10})},spawnApples(e){e=Math.min(e,p.applesRealMax-p.appleArray.length);for(let t=0;t<e;t++)this.spawnApple()},getApple(e){p.appleArray[e]&&(p.apples=p.apples.plus(p.appleGain))},preventLeavingArea(e){let a=t("#aa").getBoundingClientRect(),l=e.getBoundingClientRect().width,p=Number(getComputedStyle(e).marginLeft.slice(0,-2))||0,s=Number(getComputedStyle(e).marginTop.slice(0,-2))||0,i=getComputedStyle(t("#aa")).borderWidth.slice(0,-2);p>a.width-l-2*i?e.style.marginLeft=a.width-l-2*i+"px":p<-a.width+l+2*i&&(e.style.marginLeft=-a.width+l+2*i+"px"),s>a.width-l-2*i?e.style.marginTop=a.width-l-2*i+"px":s<-a.width+l+2*i&&(e.style.marginTop=-a.width+l+2*i+"px")}};function n(){if(p.levelRequirement=e(25).times(e(4).pow(p.level)),p.apples.gte(p.levelRequirement)){const e=p.apples.div(25).log(4).minus(p.level).max(0).plus(1).floor();p.level=p.level.plus(e)}p.size=e(1).times(p.upgrades.au1.effect()),p.tierRequirement=e(49).pow(p.tier.plus(1)),p.size.gte(p.tierRequirement)&&(p.tier=p.tier.plus(1),p.appleArray=[],p.applesOnField=0),p.tierEffect=e("8e5").pow(p.tier),p.speed=e(4).times(p.upgrades.au2.effect()),p.applesMax=p.upgrades.au3.effect().times(3).floor(),p.applesRealMax=+p.applesMax.div(e(1e4).pow(p.tier)).min(5e3).floor().max(1),p.appleSpawningRate=e(.5).times(p.upgrades.au4.effect()).div(e("e5").pow(p.tier)),p.levelEffect=e(2).pow(p.level),p.appleGain=p.tierEffect.times(p.levelEffect),t("#p").style.setProperty("--size",p.size.div(e(49).pow(p.tier))+"px");const a=Number(getComputedStyle(t("#p")).marginLeft.slice(0,-2))||0,n=Number(getComputedStyle(t("#p")).marginTop.slice(0,-2))||0,r=+p.speed.div(e(49).pow(p.tier).div(p.tier.gt(0)?4:1));(p.keyPressed.ArrowLeft||p.keyPressed.KeyA||p.keyPressed.ml)&&(t("#p").style.marginLeft=a-r+"px"),(p.keyPressed.ArrowRight||p.keyPressed.KeyD||p.keyPressed.mr)&&(t("#p").style.marginLeft=a+r+"px"),(p.keyPressed.ArrowUp||p.keyPressed.KeyW||p.keyPressed.mt)&&(t("#p").style.marginTop=n-r+"px"),(p.keyPressed.ArrowDown||p.keyPressed.KeyS||p.keyPressed.mb)&&(t("#p").style.marginTop=n+r+"px"),i.preventLeavingArea(t("#p")),p.applesOnField=e(p.applesOnField),p.applesOnField=p.applesOnField.plus(p.appleSpawningRate.times(1/l)),p.applesOnField.gt(p.applesRealMax)?p.applesOnField=p.applesRealMax:p.applesOnField=+p.applesOnField,i.spawnApples(Math.floor(p.applesOnField)-p.appleArray.length),i.drawApples(),s.updateAll()}function r(){let e={};for(const t in p)e[t]=p[t];for(let t in e)e[t]instanceof Decimal&&(e[t]=e[t].toString());localStorage.setItem("Applemania",btoa(JSON.stringify(e)))}document.addEventListener("DOMContentLoaded",(function(){s.updateAll(),document.addEventListener("keydown",(function(e){p.keyPressed[e.code]=!0})),document.addEventListener("keyup",(function(e){p.keyPressed[e.code]=!1})),t("#au1").addEventListener("click",(function(){let e=p.upgrades.au1;e.condition()&&(p.upgrades.au1.lvl=e.lvl.plus(e.bulk()),p.apples=p.apples.minus(e.cost(p.upgrades.au1.lvl.minus(1))))})),t("#au2").addEventListener("click",(function(){let e=p.upgrades.au2;e.condition()&&(p.upgrades.au2.lvl=e.lvl.plus(e.bulk()),p.apples=p.apples.minus(e.cost(p.upgrades.au2.lvl.minus(1))))})),t("#au3").addEventListener("click",(function(){let e=p.upgrades.au3;e.condition()&&(p.upgrades.au3.lvl=e.lvl.plus(e.bulk()),p.apples=p.apples.minus(e.cost(p.upgrades.au3.lvl.minus(1))))})),t("#au4").addEventListener("click",(function(){let e=p.upgrades.au4;e.condition()&&(p.upgrades.au4.lvl=e.lvl.plus(e.bulk()),p.apples=p.apples.minus(e.cost(p.upgrades.au4.lvl.minus(1))))})),t("#ml").addEventListener("touchstart",(function(){p.keyPressed.ml=!0})),t("#ml").addEventListener("touchend",(function(){p.keyPressed.ml=!1})),t("#mr").addEventListener("touchstart",(function(){p.keyPressed.mr=!0})),t("#mr").addEventListener("touchend",(function(){p.keyPressed.mr=!1})),t("#mt").addEventListener("touchstart",(function(){p.keyPressed.mt=!0})),t("#mt").addEventListener("touchend",(function(){p.keyPressed.mt=!1})),t("#mb").addEventListener("touchstart",(function(){p.keyPressed.mb=!0})),t("#mb").addEventListener("touchend",(function(){p.keyPressed.mb=!1})),t("#ml").addEventListener("mousedown",(function(){p.keyPressed.ml=!0})),t("#ml").addEventListener("mouseup",(function(){p.keyPressed.ml=!1})),t("#mr").addEventListener("mousedown",(function(){p.keyPressed.mr=!0})),t("#mr").addEventListener("mouseup",(function(){p.keyPressed.mr=!1})),t("#mt").addEventListener("mousedown",(function(){p.keyPressed.mt=!0})),t("#mt").addEventListener("mouseup",(function(){p.keyPressed.mt=!1})),t("#mb").addEventListener("mousedown",(function(){p.keyPressed.mb=!0})),t("#mb").addEventListener("mouseup",(function(){p.keyPressed.mb=!1})),function(t){let a=function(t=localStorage.getItem("Applemania")){let a=!1;try{JSON.parse(t),a=!0}catch{a=!1}a&&(r(),t=btoa(t));if(t){t=JSON.parse(atob(t));for(let a in t)if(t.hasOwnProperty(a)){if("string"==typeof t[a]&&(t[a].includes("e")||/\d/.test(t[a]))){const l=e(t[a]).toNumber();isNaN(l)||null==l||(t[a]=e(t[a]))}if("upgrades"===a){let a=t.upgrades;t.upgrades=p.upgrades;for(let l in t.upgrades)void 0!==a[l]&&(t.upgrades[l].lvl=e(a[l].lvl))}}}return t}(t);if(a)for(let e in a)p[e]=a[e]}(),i.spawnApple(),p.applesOnField=p.appleArray.length,setInterval(r,1e4),setInterval(n,1e3/l)}))}();